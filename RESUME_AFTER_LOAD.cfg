[gcode_macro RESUME_AFTER_LOAD]
gcode:
  {% set R = params.R|default(0)|float %}

  SAVE_GCODE_STATE NAME=resume
  M83
  {% if R > 0 %}
  G1 E{R} F300
  {% endif }
  RESUME
  RESTORE_GCODE_STATE NAME=resume
