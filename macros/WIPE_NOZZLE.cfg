[gcode_macro WIPE_NOZZLE]
variable_total_retract: 25.2
gcode:
    {% set th = printer.toolhead %}

    SAVE_GCODE_STATE NAME=wipe_nozzle

    PARK
    G90
    G0 X{th.axis_maximum.x-5} Y{th.axis_maximum.y-1} Z0.12 F10000

    FORM_TIP RETRACT=4

    G90
    G1 Y240 F10000
    G1 X{th.axis_maximum.x-5} Y{th.axis_maximum.y-1} Z20 F10000

    G0 X{th.axis_maximum.x-5} Y{th.axis_maximum.y-1} Z0.12 F10000
    G1 Y240 F10000

    PARK
    RESTORE_GCODE_STATE NAME=wipe_nozzle

[gcode_macro WIPE_NOZZLE_RESTORE]
gcode:
    SAVE_GCODE_STATE NAME=wipe_nozzle_restore

    G92 E0
    G0 E{printer['gcode_macro WIPE_NOZZLE']['total_retract']} F400

    RESTORE_GCODE_STATE NAME=wipe_nozzle_restore
